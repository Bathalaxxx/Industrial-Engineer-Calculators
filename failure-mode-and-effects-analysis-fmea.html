<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FMEA Calculator | Industrial Engineering Calculators</title>
    <meta name="description" content="Free online FMEA tool to perform Failure Mode & Effects Analysis. Calculate RPN, prioritize risks, and improve quality engineering processes.">
    <meta name="keywords" content="fmea, pfmea, failure mode and effects analysis, risk analysis, rpn calculator, severity, occurrence, detection, quality engineering">
    
    <!--FAVICON-->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3BSHG1DE6V"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-3BSHG1DE6V');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5607576434988374" crossorigin="anonymous"></script>
    <meta name="google-adsense-account" content="ca-pub-5607576434988374">
    
    <!-- Clarity tracking code for https://iecalculators.online/ -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "t31aicr9ep");
    </script>

    <style>
        /* Adopted from your design system */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --text-color: #333;
            --text-light: #7f8c8d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: #f5f7fa;
        }

        /* Navigation styles (from your files) */
        .sidebar-toggle {
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1000;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 1.2rem;
            display: block;
        }
        
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100%;
            background-color: var(--light-color);
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            overflow-y: auto;
            transition: left 0.3s;
            z-index: 999;
            padding: 20px 0;
        }
        
        .sidebar.open {
            left: 0;
        }
        
        .sidebar-header {
            padding: 0 20px 15px;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .sidebar-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-color);
        }
        
        .sidebar-category {
            margin-bottom: 10px;
        }
        
        .sidebar-category-header {
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .sidebar-category-header:hover {
            background-color: rgba(0,0,0,0.05);
        }
        
        .sidebar-category-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .sidebar-category.open .sidebar-category-content {
            max-height: 1000px;
        }
        
        .sidebar-link {
            display: block;
            padding: 8px 20px 8px 35px;
            color: var(--text-color);
            text-decoration: none;
            transition: background-color 0.3s;
        }
        
        .sidebar-link:hover {
            background-color: rgba(0,0,0,0.05);
        }
        
        body.sidebar-open {
            overflow: hidden;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 998;
            display: none;
        }
        
        .overlay.active {
            display: block;
        }
        
        /* Add color coding to sidebar categories */
        .sidebar-category-header.production {
            color: var(--production-color);
        }
        .sidebar-category-header.quality {
            color: var(--quality-color);
        }
        .sidebar-category-header.statistics {
            color: var(--statistics-color);
        }
        .sidebar-category-header.inventory {
            color: var(--inventory-color);
        }
        .sidebar-category-header.workstudy {
            color: var(--workstudy-color);
        }
        .sidebar-category-header.ergonomics {
            color: var(--ergonomics-color);
        }
        .sidebar-category-header.operations {
            color: var(--operations-color);
        }
        .sidebar-category-header.economy {
            color: var(--economy-color);
        }
        .sidebar-category-header.facilities {
            color: var(--facilities-color);
        }
        .sidebar-category-header.reliability {
            color: var(--reliability-color);
        }

        .related-tools {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .tool-chip {
            background-color: #e3f2fd;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--primary-color);
            text-decoration: none;
            transition: background-color 0.3s;
        }
        
        .tool-chip:hover {
            background-color: #bbdefb;
        }             
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .logo span {
            color: var(--secondary-color);
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 1.5rem;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        nav ul li a:hover {
            color: var(--secondary-color);
        }
        
        .page-hero {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .page-hero h1 {
            font-size: 2.2rem;
        }
        
        .content-section {
            background-color: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .content-section h2 {
            color: var(--secondary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--light-color);
        }
        
        /* FMEA-specific styles */
        .calculation-block {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.25rem;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .calculation-title {
            font-weight: 800;
            font-size: 1.2em;
            margin-bottom: 1rem;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            padding-bottom: 0.6rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
            font-weight: 600;
        }
        
        input[type="text"], textarea, select {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 1rem;
            transition: border 0.3s, box-shadow 0.3s;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        input:focus, textarea:focus, select:focus, button:focus-visible {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        button {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.7rem 1.25rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: background-color 0.3s;
            font-weight: 600;
        }
        
        button:hover { background-color: #2980b9; }
        button:disabled { background-color: #95a5a6; cursor: not-allowed; }

        .panels-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1.25rem;
            justify-content: center;
            width: 100%;
            margin-bottom: 1.25rem;
        }
        
        #network-wrapper {
            position: relative; 
            width: 100%;
            margin: 1.25rem auto;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 1rem;
        }

        #networkChart { width: 100%; height: 600px; position: relative; }
        
        #networkIcon {
            position: absolute;
            top: 25px;
            left: 25px;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            z-index: 1001;
            filter: invert(1);
        }

        #fitViewBtn, #exportChartBtn {
            position: absolute;
            top: 25px;
            z-index: 1001;
            padding: 0.5rem 0.75rem;
        }
        #fitViewBtn { right: 25px; }
        #exportChartBtn { right: 80px; background-color: #16a085; }
        #exportChartBtn:hover { background-color: #117a65; }

        #generateFMEABtn { position: absolute; bottom: 25px; right: 25px; z-index: 1001; padding: 0.6rem 1rem; font-size: 1em; background-color: #27ae60; }
        #generateFMEABtn:hover { background-color: #229954; }

        #network-instruction {
            position: absolute; top: 1rem; left: 50%; transform: translateX(-50%);
            color: #888; font-size: 0.9rem; font-style: italic;
            pointer-events: none; z-index: 1001;
        }

        #componentsPanel, #contactsPanel, #functionsPanel {
            background: white; padding: 1.25rem; border-radius: 8px; border: 1px solid #ddd;
            width: 300px; min-width: 250px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            flex-grow: 1;
        }
        
        .item-list { margin-top: 1rem; max-height: none; overflow-y: visible; }
        .item { padding: 0.6rem; margin-bottom: 0.5rem; border: 1px solid #ddd; border-radius: 4px; background-color: #f8f9fa; display: flex; justify-content: space-between; align-items: center; }
        .item-name { flex-grow: 1; margin-right: 0.6rem; }
        .item-actions button { padding: 5px 8px; font-size: 0.8rem; margin: 0 2px; }
            
        #fmeaResultsContainer { display: none; margin-top: 1.25rem; }
        
        .analysis-instance {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid var(--secondary-color);
        }
        .analysis-instance:first-child {
            margin-top: 0;
            padding-top: 0;
            border-top: none;
        }
        .analysis-note {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            color: #555;
            font-size: 0.9rem;
        }
        
        .fmea-table-wrapper {
            overflow-x: auto;
            width: 100%;
            -webkit-overflow-scrolling: touch;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-top: 1.25rem;
        }

        .fmea-table {
            border-collapse: collapse;
            width: 100%;
            min-width: 1200px;
            background: white;
        }

        .fmea-table th, .fmea-table td { border: 1px solid #ddd; padding: 0.5rem; text-align: left; vertical-align: top; white-space: normal; }
        .fmea-table textarea { width: 100%; border: none; background-color: transparent; padding: 2px; margin: 0; font-family: inherit; font-size: inherit; color: inherit; box-shadow: none; border-radius: 0; resize: none; overflow-y: hidden; min-height: 20px; }
        .fmea-table textarea:focus { background-color: #eef5ff; }

        .fmea-table select { width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 3px; background-color: white; font-size: 0.9rem; }
        .fmea-table select:focus { border-color: var(--secondary-color); outline: 1px solid var(--secondary-color); }
        .fmea-table th { background-color: var(--primary-color); color: white; font-weight: 600; }
        .fmea-table tr:nth-child(even) { background-color: #f8f9fa; }
        
        .rpn-cell.severity-high { background-color: #ffdddd; }
        .rpn-cell.severity-medium { background-color: #fff3cd; }
        
        .add-failure-mode { background-color: #f39c12; margin-top: 5px; }
        .add-failure-mode:hover { background-color: #e67e22; }
        
        .function-item { border-left: 5px solid; padding-left: 0.6rem; }

        .action-item { display: flex; align-items: flex-start; margin-bottom: 5px; }
        .action-item textarea { margin-right: 5px; flex-grow: 1; }
        .delete-action-btn { background-color: #e74c3c; padding: 5px 8px; font-size: 0.8rem; min-width: 30px; }
        .delete-action-btn:hover { background-color: #c0392b; }
        .add-action-btn { background-color: #27ae60; margin-top: 5px; }
        .add-action-btn:hover { background-color: #229954; }
        
        .export-fmea-btn { margin-top: 10px; }

        #networkLegend {
            position: absolute; bottom: 10px; left: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 0.6rem; border-radius: 5px; font-size: 0.8rem;
            z-index: 1000; max-height: 90%; overflow-y: auto; border: 1px solid #ddd;
        }
        #networkLegend div { margin: 5px 0; }
        #networkLegend span { display: inline-block; width: 15px; height: 15px; margin-right: 5px; vertical-align: middle; border: 1px solid #ccc; }

        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 2rem 0;
            text-align: center;
            margin-top: 2rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            margin-bottom: 1.5rem;
        }
        
        .footer-links a {
            color: white;
            margin: 0 1rem;
            text-decoration: none;
        }
        
        .footer-links a:hover {
            text-decoration: underline;
        }
        
        .copyright {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .disclaimer-note { 
            margin-top: 2rem; 
            padding: 0 1rem; 
            font-size: 0.8rem; 
            color: #777; 
            max-width: 800px; 
            margin-left: auto; 
            margin-right: auto; 
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            nav ul {
                margin-top: 1rem;
                justify-content: center;
            }
            
            nav ul li {
                margin: 0 0.75rem;
            }
            
            .panels-container { 
                flex-direction: column; 
            }
            #componentsPanel, #contactsPanel, #functionsPanel { 
                width: 100%; 
            }
            
            .input-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>


    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">Industrial Engineering <span>Calculators</span></div>
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="terms.html">Terms</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="contact.html">Contact</a></li>
                        <li></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    
    <section class="page-hero">
        <div class="container">
            <h1>FMEA Calculator</h1>
            <p>Perform Failure Mode & Effects Analysis to identify and mitigate potential risks</p>
        </div>
    </section>
    
    <main class="container">
        <section class="content-section">
            <h2>What is Failure Mode & Effects Analysis (FMEA)?</h2>
            <p><strong>Failure Mode and Effects Analysis (FMEA)</strong> is a systematic, proactive method for evaluating a process or design to identify where and how it might fail and to assess the relative impact of different failures. The goal is to identify, prioritize, and eliminate or reduce potential failures, starting with the highest-priority ones.</p>
            <p>Key components of an FMEA include:</p>
            <ul style="padding-left: 1.0em;">
                <li><strong>Failure Modes:</strong> The specific ways in which a component, system, or process could fail to meet the design intent.</li>
                <li><strong>Effects of Failure:</strong> The consequences of a failure mode on the system, customer, or downstream processes.</li>
                <li><strong>Causes of Failure:</strong> The design or process weaknesses, errors, or conditions that could trigger the failure mode.</li>
                <li><strong>Risk Priority Number (RPN):</strong> A numerical ranking of the risk associated with each potential failure. It is calculated as:
                    <strong>RPN = Severity (S) × Occurrence (O) × Detection (D)</strong>
                    <ul style="padding-left: 1.0em;">
                        <li><strong>Severity (S):</strong> The seriousness of the effect of the failure.</li>
                        <li><strong>Occurrence (O):</strong> The likelihood that the cause of the failure will occur.</li>
                        <li><strong>Detection (D):</strong> The ability of current controls to detect the cause or the failure mode before it reaches the customer.</li>
                    </ul>
                </li>
            </ul>
        </section>

        <script async="async" data-cfasync="false" src="//pl27511448.profitableratecpm.com/5d225b5e0b22c0980e365900e2390e1d/invoke.js"></script> <!-- adterra native banner -->
                <div id="container-5d225b5e0b22c0980e365900e2390e1d"></div>    <!-- adterra native banner -->


        <div class="calculation-block">
            <button id="loadExampleBtn" style="background-color: #27ae60;"><i class="fas fa-lightbulb"></i> Load Example</button>
            <button id="resetAllBtn" style="background-color: #f39c12;"><i class="fas fa-redo"></i> Reset All</button>
        </div>

        <div class="panels-container">
            <div id="componentsPanel" class="calculation-block">
                <div class="calculation-title">Components</div>
                <div class="form-group">
                    <label for="componentName"><i class="fas fa-cube"></i> Component Name:</label>
                    <input type="text" id="componentName" placeholder="Enter component name">
                    <label>
                        <input type="checkbox" id="componentExternal" style="width: auto; margin-right: 5px;"> External Component
                    </label>
                    <button id="addComponentBtn"><i class="fas fa-plus"></i> Add Component</button>
                    <button id="clearComponentsBtn"><i class="fas fa-trash"></i> Clear All</button>
                </div>
                <div class="item-list" id="componentsList"></div>
            </div>

            <div id="contactsPanel" class="calculation-block">
                <div class="calculation-title">Contacts</div>
                <div class="form-group">
                    <label for="contactFrom"><i class="fas fa-arrow-right"></i> From Component:</label>
                    <select id="contactFrom" disabled><option value="">Select component</option></select>
                    <label for="contactTo"><i class="fas fa-arrow-left"></i> To Component:</label>
                    <select id="contactTo" disabled><option value="">Select component</option></select>
                    <button id="addContactBtn" disabled><i class="fas fa-plus"></i> Add Contact</button>
                    <button id="clearContactsBtn" disabled><i class="fas fa-trash"></i> Clear All</button>
                </div>
                <div class="item-list" id="contactsList"></div>
            </div>

            <div id="functionsPanel" class="calculation-block">
                <div class="calculation-title">Functions</div>
                <div class="form-group">
                    <label for="functionName"><i class="fas fa-bolt"></i> Function Name:</label>
                    <input type="text" id="functionName" placeholder="Enter function name">
                    <label for="functionType">Function Type:</label>
                    <select id="functionType">
                        <option value="primary">Primary</option>
                        <option value="secondary">Secondary</option>
                    </select>
                    <label for="functionContacts"><i class="fas fa-link"></i> Contacts:</label>
                    <select id="functionContacts" multiple disabled></select>
                    <button id="addFunctionBtn" disabled><i class="fas fa-plus"></i> Add Function</button>
                    <button id="clearFunctionsBtn" disabled><i class="fas fa-trash"></i> Clear All</button>
                </div>
                <div class="item-list" id="functionsList"></div>
            </div>
        </div>

        <div id="network-wrapper">
            <button id="exportChartBtn" title="Export Chart as JPG"><i class="fas fa-camera"></i></button>
            <button id="fitViewBtn" title="Fit to View"><i class="fas fa-compress-arrows-alt"></i></button>
            <button id="generateFMEABtn"><i class="fas fa-file-alt"></i> Generate FMEA</button>
            <div id="networkChart">
                <div id="network-instruction">Drag nodes to rearrange the layout</div>
                <div id="networkCanvas" style="width: 100%; height: 100%;"></div>
                <div id="networkLegend"><div><strong>Function Legend:</strong></div><div>No functions defined.</div></div>
            </div>
        </div>

        <div id="fmeaResultsContainer" class="calculation-block">
            <div class="calculation-title">FMEA Results</div>
            <!-- Analysis instances will be added here dynamically -->
        </div>



        <section class="content-section">
            <h2>How to Use This Tool</h2>
            <ol style="padding-left: 1.0em;">
                <li><strong>Establish Framework:</strong> Within the "Components" section, include all elements or stages of your system/operation. Designate components as "External" when they exist outside your system's scope (such as users or power supplies).</li>
                <li><strong>Specify Connections:</strong> Using the "Contacts" panel, outline the links and relationships between the components you've included.</li>
                <li><strong>Outline Operations:</strong> In the "Functions" area, explain the intended operations of your system. Allocate each function to the relevant contacts responsible for its execution.</li>
                <li><strong>Visual Representation:</strong> The application automatically produces a structural diagram (network chart) to illustrate your system's components, connections, and operations. Nodes can be repositioned by dragging.</li>
                <li><strong>Create FMEA Table:</strong> Select the "Generate FMEA" option. This action produces a new FMEA analysis section below, derived from your defined functions. Each activation creates a fresh analysis, enabling version comparisons.</li>
                <li><strong>Evaluate Malfunctions:</strong> For every function listed, document potential failure types, their impacts, likely origins, and existing preventive or detection measures.</li>
                <li><strong>Risk Evaluation:</strong> Utilize the dropdown menus to assign ratings for <strong>Severity (S)</strong>, <strong>Frequency (O)</strong>, and <strong>Detectability (D)</strong>. The application automatically computes the Risk Priority Number (RPN) to assist with prioritization.</li>
                <li><strong>Implement Measures & Export:</strong> For high-risk elements, specify recommended corrective actions. Upon completion, you can export the specific FMEA table to an Excel document for archival purposes.</li>
            </ol>
            </div>
        </section>

        
        <section class="content-section">
            <h2>Related Tools</h2>
            <div>               
                <div class="related-tools">
                    <a href="flowshopsequencing.html" class="tool-chip">Flow Shop Sequencing</a>
                    <a href="jobshopsequencing.html" class="tool-chip">Job Shop Sequencing</a>
                    <a href="linebalancing.html" class="tool-chip">Line Balancing</a>
                    <a href="takttime.html" class="tool-chip">Takt Time</a>
                    <a href="synchronousservicing.html" class="tool-chip">Synchronous Servicing</a>
                    <a href="facilitieslocation.html" class="tool-chip">Facilities Location</a>
                    <a href="reliabilityanalysis.html" class="tool-chip">Reliability Analysis</a>
                </div>
            </div>
        </section>
        <script src="https://utteranc.es/client.js"
            repo="Bathalaxxx Industrial-Engineer-Calculators"
            issue-term="pathname"
            label="Comment"
            theme="github-light"
            crossorigin="anonymous"
            async>
        </script>
    </main>
    
    <footer>
        <div class="container">
            <div class="footer-links">
                <a href="index.html">Home</a>
                <a href="about.html">About</a>
                <a href="terms.html">Terms of Service</a>
                <a href="privacy.html">Privacy Policy</a>
                <a href="contact.html">Contact Us</a>
                
            </div>
            <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="IndEnggcalculators" data-color="#FFDD00" data-emoji="" data-font="Cookie" data-text="Support our work!" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff"></script>
            <p class="copyright">© 2025 Industrial Engineering Calculators. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Navigation functionality (from your files)
        document.addEventListener('DOMContentLoaded', function() {
            const sidebarToggle = document.querySelector('.sidebar-toggle');
            const sidebar = document.querySelector('.sidebar');
            const sidebarClose = document.querySelector('.sidebar-close');
            const overlay = document.querySelector('.overlay');
            const categoryHeaders = document.querySelectorAll('.sidebar-category-header');
            
            sidebarToggle.addEventListener('click', function() {
                sidebar.classList.add('open');
                overlay.classList.add('active');
                document.body.classList.add('sidebar-open');
            });
            
            function closeSidebar() {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
                document.body.classList.remove('sidebar-open');
            }
            
            sidebarClose.addEventListener('click', closeSidebar);
            overlay.addEventListener('click', closeSidebar);
            
            categoryHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    const category = this.parentElement;
                    category.classList.toggle('open');
                    const icon = this.querySelector('span:last-child');
                    icon.textContent = category.classList.contains('open') ? '−' : '+';
                });
            });
            
            // Initialize FMEA tool
            initComponents();
        });


        
        // --- FMEA TOOL LOGIC ---
        let components = [];
        let contacts = [];
        let functions = [];
        let network = null;
        let analysisCounter = 0;
        
        let contactCounter = 0;
        let primaryFunctionCounter = 0;
        let secondaryFunctionCounter = 0;

        let componentsList, contactsList, functionsList, contactFromSelect, contactToSelect, functionContactsSelect, networkLegend, fmeaResultsContainer;

        const functionColors = [ '#e74c3c', '#3498db', '#2ecc71', '#f1c40f', '#9b59b6', '#1abc9c', '#e67e22', '#34495e', '#d35400', '#27ae60' ];
        
        function initComponents(){
            componentsList = document.getElementById('componentsList');
            contactsList = document.getElementById('contactsList');
            functionsList = document.getElementById('functionsList');
            contactFromSelect = document.getElementById('contactFrom');
            contactToSelect = document.getElementById('contactTo');
            functionContactsSelect = document.getElementById('functionContacts');
            networkLegend = document.getElementById('networkLegend');
            fmeaResultsContainer = document.getElementById('fmeaResultsContainer');
            
            document.getElementById('addComponentBtn').addEventListener('click', addComponent);
            document.getElementById('addContactBtn').addEventListener('click', addContact);
            document.getElementById('addFunctionBtn').addEventListener('click', addFunction);
            document.getElementById('generateFMEABtn').addEventListener('click', generateFMEA);
            document.getElementById('exportChartBtn').addEventListener('click', exportChart);
            document.getElementById('clearComponentsBtn').addEventListener('click', resetAll);
            document.getElementById('clearContactsBtn').addEventListener('click', () => { contacts = []; functions = []; contactCounter = 0; primaryFunctionCounter = 0; secondaryFunctionCounter = 0; updateAll(); });
            document.getElementById('clearFunctionsBtn').addEventListener('click', () => { functions = []; primaryFunctionCounter = 0; secondaryFunctionCounter = 0; updateAll(); });
            document.getElementById('fitViewBtn').addEventListener('click', () => { if (network) network.fit({ animation: true }); });
            document.getElementById('loadExampleBtn').addEventListener('click', loadExample);
            document.getElementById('resetAllBtn').addEventListener('click', resetAll);
            updateAll();
        }


        function getFunctionColor(id) {
            return functionColors[(id - 1) % functionColors.length];
        }
        
        function autoGrowTextarea(element) {
            element.style.height = "auto";
            element.style.height = (element.scrollHeight) + "px";
        }

        function loadExample() {
            resetAll();
            components = [ { id: 1, name: 'Motor', external: false }, { id: 2, name: 'Gearbox', external: false }, { id: 3, name: 'Controller', external: false }, { id: 4, name: 'Power Supply', external: true }, { id: 5, name: 'Sensor', external: false }, { id: 6, name: 'Actuator', external: false }, { id: 7, name: 'Display Unit', external: false }, { id: 8, name: 'User Interface', external: true } ];
            contactCounter = 8;
            contacts = [ { id: 1, from: 1, to: 2, name: 'c1' }, { id: 2, from: 3, to: 1, name: 'c2' }, { id: 3, from: 4, to: 3, name: 'c3' }, { id: 4, from: 5, to: 3, name: 'c4' }, { id: 5, from: 3, to: 6, name: 'c5' }, { id: 6, from: 3, to: 7, name: 'c6' }, { id: 7, from: 8, to: 3, name: 'c7' }, { id: 8, from: 2, to: 6, name: 'c8' } ];
            primaryFunctionCounter = 3;
            secondaryFunctionCounter = 1;
            functions = [ { id: 1, name: 'Transmit Power', type: 'primary', label: 'fp1', contacts: [1, 8], failureModes: [{ mode: 'Gear slippage', effects: 'Reduced power transmission', severity: 8, causes: 'Worn gears', occurrence: 4, controls: 'Regular maintenance', detection: 3, actions: ['Implement preventive maintenance schedule'] }] }, { id: 2, name: 'Control Speed', type: 'primary', label: 'fp2', contacts: [2, 3, 4], failureModes: [{ mode: 'Controller software malfunction', effects: 'Uncontrolled motor speed', severity: 9, causes: 'Software bug', occurrence: 2, controls: 'Software testing', detection: 2, actions: ['Implement robust error handling', 'Add watchdog timer'] }] }, { id: 3, name: 'Provide System Status', type: 'secondary', label: 'fs1', contacts: [6, 7], failureModes: [{ mode: 'Display unit malfunction', effects: 'No system feedback', severity: 5, causes: 'LCD damage', occurrence: 2, controls: 'Protective casing', detection: 6, actions: ['Implement audio alerts as backup'] }] }, { id: 4, name: 'Execute Commands', type: 'primary', label: 'fp3', contacts: [5, 7], failureModes: [{ mode: 'Actuator jamming', effects: 'Command not executed', severity: 8, causes: 'Foreign object', occurrence: 3, controls: 'Regular cleaning', detection: 3, actions: ['Implement force feedback to detect jam', 'Add enclosure to prevent debris entry'] }] } ];
            updateAll();
        }

        function resetAll() {
            components = []; contacts = []; functions = [];
            contactCounter = 0; primaryFunctionCounter = 0; secondaryFunctionCounter = 0;
            analysisCounter = 0;
            fmeaResultsContainer.style.display = 'none';
            const instances = fmeaResultsContainer.querySelectorAll('.analysis-instance');
            instances.forEach(instance => instance.remove());

            if (network) {
                network.destroy();
                network = null;
            }
            updateAll();
            networkLegend.innerHTML = '';
        }

        function addComponent() {
            const name = document.getElementById('componentName').value.trim();
            if (name) {
                const isExternal = document.getElementById('componentExternal').checked;
                const newId = components.length > 0 ? Math.max(...components.map(c => c.id)) + 1 : 1;
                components.push({ id: newId, name, external: isExternal });
                document.getElementById('componentName').value = '';
                document.getElementById('componentExternal').checked = false;
                updateAll();
            }
        }

        function addContact() {
            const fromId = parseInt(contactFromSelect.value);
            const toId = parseInt(contactToSelect.value);
            if (fromId && toId && fromId !== toId) {
                contactCounter++;
                const newId = contacts.length > 0 ? Math.max(...contacts.map(c => c.id)) + 1 : 1;
                contacts.push({ id: newId, from: fromId, to: toId, name: `c${contactCounter}` });
                updateAll();
            }
        }

        function addFunction() {
            const name = document.getElementById('functionName').value.trim();
            const type = document.getElementById('functionType').value;
            const selectedContacts = Array.from(functionContactsSelect.selectedOptions).map(option => parseInt(option.value));
            if (name && selectedContacts.length > 0) {
                const newId = functions.length > 0 ? Math.max(...functions.map(f => f.id)) + 1 : 1;
                let funcLabel = '';
                if (type === 'primary') {
                    primaryFunctionCounter++;
                    funcLabel = `fp${primaryFunctionCounter}`;
                } else {
                    secondaryFunctionCounter++;
                    funcLabel = `fs${secondaryFunctionCounter}`;
                }
                functions.push({ id: newId, name, type, contacts: selectedContacts, label: funcLabel, failureModes: [] });
                document.getElementById('functionName').value = '';
                updateAll();
            }
        }

        function updateComponentsList() {
            componentsList.innerHTML = '';
            components.forEach(component => {
                const item = document.createElement('div');
                item.className = 'item';
                item.innerHTML = `
                    <div class="item-name">${component.name} ${component.external ? '(External)' : ''}</div>
                    <div class="item-actions"><button class="delete-btn" title="Delete"><i class="fas fa-trash"></i></button></div>`;
                item.querySelector('.delete-btn').addEventListener('click', () => {
                    contacts = contacts.filter(c => c.from !== component.id && c.to !== component.id);
                    const contactIds = contacts.map(c => c.id);
                    functions = functions.filter(f => f.contacts.every(cId => contactIds.includes(cId)));
                    components = components.filter(c => c.id !== component.id);
                    updateAll();
                });
                componentsList.appendChild(item);
            });
            document.getElementById('addContactBtn').disabled = components.length < 2;
        }

        function updateContactsList() {
            contactsList.innerHTML = '';
            contacts.forEach(contact => {
                const from = components.find(c => c.id === contact.from);
                const to = components.find(c => c.id === contact.to);
                if (from && to) {
                    const item = document.createElement('div');
                    item.className = 'item';
                    item.innerHTML = `
                        <div class="item-name"><strong>${contact.name}:</strong> ${from.name} → ${to.name}</div>
                        <div class="item-actions"><button class="delete-btn" title="Delete"><i class="fas fa-trash"></i></button></div>`;
                    item.querySelector('.delete-btn').addEventListener('click', () => {
                        functions.forEach(f => { f.contacts = f.contacts.filter(id => id !== contact.id); });
                        functions = functions.filter(f => f.contacts.length > 0);
                        contacts = contacts.filter(c => c.id !== contact.id);
                        updateAll();
                    });
                    contactsList.appendChild(item);
                }
            });
            document.getElementById('clearContactsBtn').disabled = contacts.length === 0;
        }

        function updateFunctionsList() {
            functionsList.innerHTML = '';
            functions.forEach(func => {
                const item = document.createElement('div');
                item.className = 'item function-item';
                item.style.borderColor = getFunctionColor(func.id);
                const funcContacts = contacts.filter(c => func.contacts.includes(c.id));
                const contactNames = funcContacts.map(c => c.name).join(', ');
                item.innerHTML = `
                    <div class="item-name"><strong>${func.label}:</strong> ${func.name} (${func.type})<br><small>Contacts: ${contactNames}</small></div>
                    <div class="item-actions"><button class="delete-btn" title="Delete"><i class="fas fa-trash"></i></button></div>`;
                item.querySelector('.delete-btn').addEventListener('click', () => {
                    functions = functions.filter(f => f.id !== func.id);
                    updateAll();
                });
                functionsList.appendChild(item);
            });
            document.getElementById('addFunctionBtn').disabled = contacts.length === 0;
            document.getElementById('clearFunctionsBtn').disabled = functions.length === 0;
        }

        function updateAll() {
            updateComponentsList();
            updateContactsList();
            updateFunctionsList();
            updateSelectOptions();
            updateNetworkVisualization();
        }

        function updateSelectOptions() {
            contactFromSelect.innerHTML = '<option value="">Select component</option>';
            contactToSelect.innerHTML = '<option value="">Select component</option>';
            components.forEach(c => {
                contactFromSelect.appendChild(new Option(c.name, c.id));
                contactToSelect.appendChild(new Option(c.name, c.id));
            });
            contactFromSelect.disabled = components.length < 2;
            contactToSelect.disabled = components.length < 2;
            
            functionContactsSelect.innerHTML = '';
            contacts.forEach(contact => {
                const from = components.find(c => c.id === contact.from);
                const to = components.find(c => c.id === contact.to);
                if (from && to) {
                    functionContactsSelect.appendChild(new Option(`${contact.name}: ${from.name} → ${to.name}`, contact.id));
                }
            });
            functionContactsSelect.disabled = contacts.length === 0;
        }

        function updateNetworkVisualization() {
            const container = document.getElementById('networkCanvas');
            if (network) {
                network.destroy();
            }
            const INTERNAL_Y_SPACING = 150;
            const INTERNAL_X_SPACING = 250;
            const EXTERNAL_Y_OFFSET = 200;

            const nodesData = [];
            const internalComponents = components.filter(c => !c.external);
            const externalComponents = components.filter(c => c.external);
            
            let internal_y_start = 0;
            internalComponents.forEach((component, i) => {
                const x = (i % 2 === 0) ? -INTERNAL_X_SPACING / 2 : INTERNAL_X_SPACING / 2;
                const y = internal_y_start + Math.floor(i / 2) * INTERNAL_Y_SPACING;
                nodesData.push({ ...component, x, y, fixed: false });
            });

            const numInternalRows = Math.ceil(internalComponents.length / 2);
            const internalZoneHeight = (numInternalRows - 1) * INTERNAL_Y_SPACING;
            
            const external_top_y = internal_y_start - EXTERNAL_Y_OFFSET;
            const external_bottom_y = internal_y_start + internalZoneHeight + EXTERNAL_Y_OFFSET;
            
            const topExternals = externalComponents.slice(0, Math.ceil(externalComponents.length / 2));
            const bottomExternals = externalComponents.slice(Math.ceil(externalComponents.length / 2));

            topExternals.forEach((component, i) => {
                const x = (topExternals.length - 1) * -100 + i * 200;
                nodesData.push({ ...component, x, y: external_top_y, fixed: false });
            });

            bottomExternals.forEach((component, i) => {
                const x = (bottomExternals.length - 1) * -100 + i * 200;
                nodesData.push({ ...component, x, y: external_bottom_y, fixed: false });
            });

            const visNodes = nodesData.map(c => {
                let nodeColor, nodeFont, nodeShape;
                const baseFont = { size: 28, face: 'Segoe UI, sans-serif' };

                if (c.external) {
                    nodeColor = { border: '#2c3e50', background: '#ecf0f1' };
                    nodeFont = { ...baseFont, color: '#2c3e50', weight: '600' };
                    nodeShape = 'box';
                } else {
                    nodeColor = { border: '#2c3e50', background: '#3498db' };
                    nodeFont = { ...baseFont, color: '#ffffff', weight: '600' };
                    nodeShape = 'box';
                }
                return {
                    id: c.id, label: c.name, x: c.x, y: c.y, fixed: c.fixed,
                    color: nodeColor, font: nodeFont, shape: nodeShape, margin: 10
                };
            });

            const edgesData = [];
            
            contacts.forEach(contact => {
                edgesData.push({
                    id: `c-${contact.id}`, from: contact.from, to: contact.to,
                    color: '#333333',
                    width: 1.5,
                    smooth: { enabled: false }
                });
            });
            
            functions.forEach(func => {
                const funcColor = getFunctionColor(func.id);
                func.contacts.forEach(contactId => {
                    const underlyingContact = contacts.find(c => c.id === contactId);
                    if (underlyingContact) {
                        edgesData.push({
                            id: `f-${func.id}-${contactId}`, from: underlyingContact.from, to: underlyingContact.to,
                            label: func.label,
                            color: { color: funcColor, highlight: funcColor },
                            arrows: { to: { enabled: true, scaleFactor: 0.7 } },
                            width: 3,
                            font: { size: 36, face: 'Segoe UI, sans-serif', color: funcColor, strokeWidth: 5, strokeColor: 'white', weight: '800' },
                            smooth: { enabled: true, type: 'curvedCW', roundness: 0.2 + (func.id * 0.05) }
                        });
                    }
                });
            });

            const data = { nodes: new vis.DataSet(visNodes), edges: new vis.DataSet(edgesData) };

            const options = {
                layout: { hierarchical: false },
                physics: { enabled: false },
                nodes: { borderWidth: 2, shadow: true },
                edges: { shadow: true },
                interaction: { hover: true, tooltipDelay: 200, dragNodes: true },
            };

            network = new vis.Network(container, data, options);

            const lineTopY = internal_y_start - (INTERNAL_Y_SPACING / 2);
            const lineBottomY = internal_y_start + internalZoneHeight + (INTERNAL_Y_SPACING / 2);

            network.on('afterDrawing', function (ctx) {
                ctx.save();
                ctx.strokeStyle = '#95a5a6';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 10]);
                const x_start = -10000;
                const x_end = 10000;
                ctx.beginPath();
                ctx.moveTo(x_start, lineTopY);
                ctx.lineTo(x_end, lineTopY);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(x_start, lineBottomY);
                ctx.lineTo(x_end, lineBottomY);
                ctx.stroke();
                ctx.restore();
            });
            
            network.fit({animation: {duration: 500, easingFunction: 'easeInOutQuad'}});

            let legendHtml = '<div><strong>Function Legend:</strong></div>';
            if (functions.length > 0) {
                functions.forEach(func => {
                    const color = getFunctionColor(func.id);
                    legendHtml += `<div><span style="background-color: ${color};"></span>${func.label}: ${func.name}</div>`;
                });
            } else {
                legendHtml += '<div>No functions defined.</div>';
            }
            networkLegend.innerHTML = legendHtml;
        }
        
        function generateFMEA() {
            analysisCounter++;
            const now = new Date();
            const timestamp = `${now.toLocaleDateString('en-US')}, ${now.toLocaleTimeString('en-US', { hour12: true })}`;
            
            const analysisInstance = document.createElement('div');
            analysisInstance.className = 'analysis-instance';
            
            const analysisNote = document.createElement('div');
            analysisNote.className = 'analysis-note';
            analysisNote.innerHTML = `
                <span><strong>Analysis #${analysisCounter}</strong> - ${timestamp}</span>`;
            analysisInstance.appendChild(analysisNote);

            const fmeaTable = document.createElement('table');
            fmeaTable.className = 'fmea-table';
            const fmeaTableHead = document.createElement('thead');
            const fmeaTableBody = document.createElement('tbody');
            fmeaTableHead.innerHTML = `
                <tr>
                    <th>Function</th><th>Type</th><th>Potential Failure Mode</th><th>Potential Effects</th><th>Severity (S)</th><th>Potential Causes</th><th>Occurrence (O)</th><th>Current Controls</th><th>Detection (D)</th><th>RPN (S×O×D)</th><th>Recommended Actions</th><th>Actions</th>
                </tr>`;
            fmeaTable.appendChild(fmeaTableHead);
            fmeaTable.appendChild(fmeaTableBody);
            
            const createActionInput = (container, value = '') => {
                const actionItem = document.createElement('div');
                actionItem.className = 'action-item';
                actionItem.innerHTML = `<textarea rows="1" placeholder="Recommended action">${value}</textarea><button class="delete-action-btn" title="Remove action"><i class="fas fa-times"></i></button>`;
                const textarea = actionItem.querySelector('textarea');
                textarea.addEventListener('input', () => autoGrowTextarea(textarea));
                setTimeout(() => autoGrowTextarea(textarea), 0);
                actionItem.querySelector('.delete-action-btn').addEventListener('click', () => actionItem.remove());
                container.appendChild(actionItem);
            };

            const addRow = (func, fm = {}) => {
                const row = document.createElement('tr');
                row.className = 'fmea-data-row';
                const severity = fm.severity || 1;
                const occurrence = fm.occurrence || 1;
                const detection = fm.detection || 1;
                const rpn = severity * occurrence * detection;
                
                let rpnClass = '';
                if (rpn >= 100) rpnClass = 'severity-high';
                else if (rpn >= 50) rpnClass = 'severity-medium';
                
                const optionsMap = {
                    severity: [ {value:1,text:"1-None"},{value:2,text:"2-Very Minor"},{value:3,text:"3-Minor"},{value:4,text:"4-Low"},{value:5,text:"5-Moderate"},{value:6,text:"6-Significant"},{value:7,text:"7-Major"},{value:8,text:"8-Extreme"},{value:9,text:"9-Serious"},{value:10,text:"10-Hazardous"} ],
                    occurrence: [ {value:1,text:"1-Extremely Unlikely (<1 in 1M)"},{value:2,text:"2-Remote (1 in 150k)"},{value:3,text:"3-Very Low (1 in 15k)"},{value:4,text:"4-Low (1 in 2k)"},{value:5,text:"5-Moderate (1 in 400)"},{value:6,text:"6-Mod. High (1 in 80)"},{value:7,text:"7-High (1 in 20)"},{value:8,text:"8-Very High (1 in 8)"},{value:9,text:"9-Extremely High (1 in 3)"},{value:10,text:"10-Inevitable (≥1 in 2)"} ],
                    detection: [ {value:1,text:"1-Certain Detection"},{value:2,text:"2-Very High Chance"},{value:3,text:"3-High Chance"},{value:4,text:"4-Mod. High Chance"},{value:5,text:"5-Moderate Chance"},{value:6,text:"6-Low Chance"},{value:7,text:"7-Very Low Chance"},{value:8,text:"8-Remote Chance"},{value:9,text:"9-Very Remote Chance"},{value:10,text:"10-No Chance"} ]
                };
                
                row.innerHTML = `
                    <td>${func.label}: ${func.name}</td><td>${func.type}</td>
                    <td><textarea rows="1" placeholder="Failure mode">${fm.mode || ''}</textarea></td>
                    <td><textarea rows="1" placeholder="Effects">${fm.effects || ''}</textarea></td>
                    <td><select class="severity-select">${optionsMap.severity.map(opt => `<option value="${opt.value}" ${opt.value === severity ? 'selected' : ''}>${opt.text}</option>`).join('')}</select></td>
                    <td><textarea rows="1" placeholder="Causes">${fm.causes || ''}</textarea></td>
                    <td><select class="occurrence-select">${optionsMap.occurrence.map(opt => `<option value="${opt.value}" ${opt.value === occurrence ? 'selected' : ''}>${opt.text}</option>`).join('')}</select></td>
                    <td><textarea rows="1" placeholder="Current controls">${fm.controls || ''}</textarea></td>
                    <td><select class="detection-select">${optionsMap.detection.map(opt => `<option value="${opt.value}" ${opt.value === detection ? 'selected' : ''}>${opt.text}</option>`).join('')}</select></td>
                    <td class="rpn-cell ${rpnClass}">${rpn}</td>
                    <td class="actions-cell"></td>
                    <td><button class="delete-failure-mode" title="Delete this failure mode"><i class="fas fa-trash"></i></button></td>`;
                
                const actionsCell = row.querySelector('.actions-cell');
                const actionsContainer = document.createElement('div');
                
                if (fm.actions && Array.isArray(fm.actions) && fm.actions.length > 0) {
                    fm.actions.forEach(action => createActionInput(actionsContainer, action));
                } else { createActionInput(actionsContainer); }
                
                const addActionButton = document.createElement('button');
                addActionButton.className = 'add-action-btn';
                addActionButton.innerHTML = '<i class="fas fa-plus"></i>';
                addActionButton.title = 'Add Action';
                addActionButton.addEventListener('click', () => createActionInput(actionsContainer));

                actionsCell.appendChild(actionsContainer);
                actionsCell.appendChild(addActionButton);
                
                row.querySelectorAll('textarea').forEach(textarea => {
                    textarea.addEventListener('input', () => autoGrowTextarea(textarea));
                    setTimeout(() => autoGrowTextarea(textarea), 0);
                });

                const updateRPN = () => {
                    const s = parseInt(row.querySelector('.severity-select').value);
                    const o = parseInt(row.querySelector('.occurrence-select').value);
                    const d = parseInt(row.querySelector('.detection-select').value);
                    const newRpn = s * o * d;
                    const rpnCell = row.querySelector('.rpn-cell');
                    rpnCell.textContent = newRpn;
                    rpnCell.className = 'rpn-cell';
                    if (newRpn >= 100) rpnCell.classList.add('severity-high');
                    else if (newRpn >= 50) rpnCell.classList.add('severity-medium');
                };
                row.querySelectorAll('select').forEach(sel => sel.addEventListener('change', updateRPN));
                
                row.querySelector('.delete-failure-mode').addEventListener('click', () => row.remove());
                fmeaTableBody.appendChild(row);
                return row;
            };

            functions.forEach(func => {
                if (func.failureModes && func.failureModes.length > 0) {
                    func.failureModes.forEach(fm => addRow(func, fm));
                } else { addRow(func); }
                
                const addRowBtnRow = fmeaTableBody.insertRow();
                const addRowBtnCell = addRowBtnRow.insertCell();
                addRowBtnCell.colSpan = 12;
                const addRowBtn = document.createElement('button');
                addRowBtn.className = 'add-failure-mode';
                addRowBtn.innerHTML = `<i class="fas fa-plus"></i> Add Failure Mode for ${func.label}`;
                addRowBtn.addEventListener('click', () => {
                    const newRow = addRow(func);
                    fmeaTableBody.insertBefore(newRow, addRowBtnRow);
                });
                addRowBtnCell.appendChild(addRowBtn);
            });
            
            const tableWrapper = document.createElement('div');
            tableWrapper.className = 'fmea-table-wrapper';
            tableWrapper.appendChild(fmeaTable);
            analysisInstance.appendChild(tableWrapper);

            const exportButton = document.createElement('button');
            exportButton.className = 'export-fmea-btn';
            exportButton.innerHTML = `<i class="fas fa-file-excel"></i> Export Analysis #${analysisCounter} to Excel`;
            exportButton.addEventListener('click', () => exportTableToExcel(fmeaTable, `FMEA_Analysis_${analysisCounter}_Industrial_Engineering_Calculators.xlsx`));
            analysisInstance.appendChild(exportButton);

            fmeaResultsContainer.appendChild(analysisInstance);
            fmeaResultsContainer.style.display = 'block';
            analysisInstance.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function exportTableToExcel(tableElement, fileName) {
            const exportData = [];
            const headers = Array.from(tableElement.querySelectorAll('thead th')).map(th => th.textContent);
            
            tableElement.querySelectorAll('tbody tr.fmea-data-row').forEach(row => {
                const rowData = {};
                const cells = row.querySelectorAll('td');
                const getSelectText = (selectEl) => selectEl.options[selectEl.selectedIndex].text;
                
                rowData[headers[0]] = cells[0].textContent;
                rowData[headers[1]] = cells[1].textContent;
                rowData[headers[2]] = cells[2].querySelector('textarea').value;
                rowData[headers[3]] = cells[3].querySelector('textarea').value;
                rowData[headers[4]] = getSelectText(cells[4].querySelector('select'));
                rowData[headers[5]] = cells[5].querySelector('textarea').value;
                rowData[headers[6]] = getSelectText(cells[6].querySelector('select'));
                rowData[headers[7]] = cells[7].querySelector('textarea').value;
                rowData[headers[8]] = getSelectText(cells[8].querySelector('select'));
                rowData[headers[9]] = cells[9].textContent;

                const actionsText = Array.from(cells[10].querySelectorAll('.action-item textarea'))
                                        .map(textarea => textarea.value.trim()).filter(val => val).join('\n');
                rowData[headers[10]] = actionsText;
                exportData.push(rowData);
            });

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(exportData);
            ws['!cols'] = [ {wch: 30}, {wch: 15}, {wch: 30}, {wch: 30}, {wch: 25}, {wch: 30}, {wch: 30}, {wch: 30}, {wch: 25}, {wch: 10}, {wch: 40} ];
            XLSX.utils.book_append_sheet(wb, ws, "FMEA Results");
            XLSX.writeFile(wb, fileName);
        }

        function exportChart() {
            const canvas = document.querySelector('#networkCanvas canvas');
            if (canvas && network) {
                const dataURL = canvas.toDataURL('image/jpeg', 1.0);
                const link = document.createElement('a');
                link.href = dataURL;
                link.download = 'fmea_structure_chart.jpg';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert('The chart is not available to be exported.');
            }
        }
    </script>

    

    <!-- xxxx navigation start xxxxx -->
    <button class="sidebar-toggle">☰</button>
    <div class="overlay"></div>
    <aside class="sidebar">
        <div class="sidebar-header">
            <h3>Navigation</h3>
            <button class="sidebar-close">×</button>
        </div>

    <div class="sidebar-category">
        <div class="sidebar-category-header">
            <span>Site Navigation</span>
            <span>+</span>
        </div>
        
        <div class="sidebar-category-content">
            <a href="index.html" class="sidebar-link">Home</a>
            <a href="about.html" class="sidebar-link">About</a>
            <a href="terms.html" class="sidebar-link">Terms of Service</a>
            <a href="privacy.html" class="sidebar-link">Privacy Policy</a>
            <a href="contact.html" class="sidebar-link">Contact Us</a>
        </div>
    </div>
        
        
        <div class="sidebar-category">
            <div class="sidebar-category-header production">
                <span>Production Planning</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="flowshopsequencing.html" class="sidebar-link">Flow Shop Sequencing</a>
                <a href="jobshopsequencing.html" class="sidebar-link">Job Shop Sequencing</a>
                <a href="linebalancing.html" class="sidebar-link">Line Balancing</a>
                <a href="takttime.html" class="sidebar-link">Takt Time</a>
                <a href="synchronousservicing.html" class="sidebar-link">Synchronous Servicing</a>
                <a href="machine-utilization-calculator.html" class="sidebar-link">Machine Utilization</a>
                <a href="manpower-calculator.html" class="sidebar-link active">Manpower Requirements</a>
                <a href="production-capacity-calculator.html" class="sidebar-link">Production Capacity</a>

            </div>
        </div>
        
        <div class="sidebar-category">
            <div class="sidebar-category-header quality">
                <span>Quality Control</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="acceptancesamplingplan.html" class="sidebar-link">Acceptance Sampling Plan</a>
                <a href="controlcharts.html" class="sidebar-link">Control Charts</a>
                <a href="processcapability.html" class="sidebar-link">Process Capability</a>
                <a href="sixsigmadpmo.html" class="sidebar-link">Six Sigma DPMO</a>
                <a href="oee-calculation.html" class="sidebar-link">OEE Calculator</a>
                <a href="quality-function-deployment" class="sidebar-link">Quality Function Deployment</a>            </div>
        </div>
        
        <div class="sidebar-category">
            <div class="sidebar-category-header statistics">
                <span>Statistics & DOE</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="anova.html" class="sidebar-link">ANOVA</a>
                <a href="chisquaretest.html" class="sidebar-link">Chi-Square Test</a>
                <a href="correlation.html" class="sidebar-link">Correlation Analysis</a>
                <a href="coefficient-of-variation-calculator.html" class="sidebar-link">Coefficient of Variation</a>
                <a href="goodnessoffit.html" class="sidebar-link">Goodness of Fit</a>
                <a href="regression.html" class="sidebar-link">Regression</a>
                <a href="samplesize.html" class="sidebar-link">Sample Size</a>
                <a href="taguchi.html" class="sidebar-link">Taguchi</a>
                <a href="ttest.html" class="sidebar-link">T-Test</a>
                <a href="ztest.html" class="sidebar-link">Z-Test</a>
            </div>
        </div>
        
        <div class="sidebar-category">
            <div class="sidebar-category-header inventory">
                <span>Inventory Management</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="abc-analysis-calculator.html" class="sidebar-link">ABC Analysis</a>
                <a href="inventory-turnover-calculator.html" class="sidebar-link">Inventory Turnover</a>
                <a href="eoq-formula.html" class="sidebar-link">Economic Order Quantity</a>
                <a href="reorder-point-calculator.html" class="sidebar-link">Reorder Point</a>
                <a href="kanban.html" class="sidebar-link">Kanban Calculator</a>
                <a href="newsvendor.html" class="sidebar-link">Newsvendor Model</a>
                <a href="safety-stock-calculator.html" class="sidebar-link">Safety Stock Calculator</a>
            </div>
        </div>
        
        <div class="sidebar-category">
            <div class="sidebar-category-header workstudy">
                <span>Work Study</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="timestudy.html" class="sidebar-link">Time Study</a>
                <a href="predeterminedmotiontimesystems.html" class="sidebar-link">Predetermined Motion Time Systems</a>
                <a href="learningcurve.html" class="sidebar-link">Learning Curve</a>
                <a href="littleslaw.html" class="sidebar-link">Little's Law</a>
                <a href="worksampling.html" class="sidebar-link">Work Sampling</a>
            </div>
        </div>
        
        <div class="sidebar-category">
            <div class="sidebar-category-header ergonomics">
                <span>Ergonomics</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="biomechanics.html" class="sidebar-link">Biomechanics</a>
                <a href="noisedose.html" class="sidebar-link">Noise Dose</a>
                <a href="posture.html" class="sidebar-link">Posture Analysis</a>
                <a href="workphysiology.html" class="sidebar-link">Work Physiology</a>
                <a href="workrest.html" class="sidebar-link">Work-Rest Cycles</a>
            </div>
        </div>
        
        <div class="sidebar-category">
            <div class="sidebar-category-header operations">
                <span>Operations Research</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="linearprogramming.html" class="sidebar-link">Linear Programming</a>
                <a href="queueing.html" class="sidebar-link">Queueing Analysis</a>
                <a href="decisionanalysis.html" class="sidebar-link">Decision Analysis</a>
                <a href="gametheory.html" class="sidebar-link">Game Theory</a>
                <a href="markov.html" class="sidebar-link">Markov Analysis</a>
            </div>
        </div>
        
        <div class="sidebar-category">
            <div class="sidebar-category-header economy">
                <span>Engineering Economy</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="breakeven.html" class="sidebar-link">Break-even Analysis</a>
                <a href="costanalysis.html" class="sidebar-link">Cost Analysis</a>
                <a href="depreciation.html" class="sidebar-link">Depreciation</a>
                <a href="timevalueofmoney.html" class="sidebar-link">Time Value of Money</a>
            </div>
        </div>
        
        <div class="sidebar-category">
            <div class="sidebar-category-header facilities">
                <span>Facilities Planning</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="facilitieslocation.html" class="sidebar-link">Facilities Location</a>
            </div>
        </div>
        
        <div class="sidebar-category">
            <div class="sidebar-category-header reliability">
                <span>Reliability & Maintenance</span>
                <span>+</span>
            </div>
            <div class="sidebar-category-content">
                <a href="reliabilityanalysis.html" class="sidebar-link">Reliability Analysis</a>
                <a href="failure-mode-and-effects-analysis-fmea.html" class="sidebar-link">FMEA</a>           
            </div>
        </div>
        <div class="sidebar-category">
            <div class="sidebar-category-header reliability">
                <span>Articles</span>
                <span>+</span>
            </div>
                <div class="sidebar-category-content">
                    <a href="Articles/Negative-Correlation-Understanding-Inverse-Relationships-in-Data.html" class="sidebar-link">Negative Correlation: Understanding Inverse Relationships in Data</a>
                    <a href="Articles/Parameter-vs-Statistic-Understanding-the-Key-Differences.html" class="sidebar-link">Statistic vs Parameter: Understanding the Key Differences</a>
                    <a href="Articles/Quality-Assurance-vs-Quality-Control-Key-Differences-Explained.html" class="sidebar-link">Quality Assurance vs Quality Control: Key Differences Explained</a>
                    <a href="Articles/ABC-Analysis-Made-Easy.html" class="sidebar-link">ABC Analysis Made Easy: Classify Your Inventory in Minutes</a>
                    <a href="Articles/EOQ-Optimize-Your-Inventory-Costs.html" class="sidebar-link">EOQ Order Quantity: Optimize Your Inventory</a>
                </div>
    </aside>
    <!-- xxxx navigation end xxxxx -->       
</body>
</html>