<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OEE Calculator - IE Toolkit</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <!-- Navigation -->
    <nav class="bg-blue-900 text-white p-4">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold">IE Toolkit</h1>
            <a href="index.html" class="hover:underline">Home</a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto py-8 px-4">
        <section class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-3xl font-semibold mb-4">Overall Equipment Effectiveness (OEE) Calculator</h2>
            <p class="text-gray-600 mb-6">Calculate OEE to assess manufacturing productivity based on Availability, Performance, and Quality, under different operational conditions.</p>

            <!-- OEE Method Selection -->
            <div class="mb-6">
                <label for="oee-method" class="block text-sm font-medium text-gray-700">Select OEE Method</label>
                <select id="oee-method" class="mt-1 p-2 w-full border rounded-md" onchange="toggleInputs()">
                    <option value="standard">Standard OEE</option>
                    <option value="shift-downtime">OEE with Shift-Based Downtime</option>
                    <option value="variable-rate">OEE with Variable Production Rates</option>
                </select>
            </div>

            <!-- Input Form -->
            <div id="input-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Common Inputs -->
                <div>
                    <label for="planned-time" class="block text-sm font-medium text-gray-700">Planned Production Time (minutes/shift)</label>
                    <input type="number" id="planned-time" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., 480" required>
                </div>
                <div>
                    <label for="downtime" class="block text-sm font-medium text-gray-700">Unplanned Downtime (minutes/shift)</label>
                    <input type="number" id="downtime" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., 30" required>
                </div>
                <div>
                    <label for="ideal-cycle-time" class="block text-sm font-medium text-gray-700">Ideal Cycle Time (seconds/unit)</label>
                    <input type="number" id="ideal-cycle-time" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., 10" required>
                </div>
                <div>
                    <label for="total-units" class="block text-sm font-medium text-gray-700">Total Units Produced (units/shift)</label>
                    <input type="number" id="total-units" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., 2000" required>
                </div>
                <div>
                    <label for="defective-units" class="block text-sm font-medium text-gray-700">Defective Units (units/shift)</label>
                    <input type="number" id="defective-units" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., 50" required>
                </div>
                <!-- Shift-Based Downtime Inputs -->
                <div id="shift-downtime-inputs" class="hidden">
                    <div>
                        <label for="setup-downtime" class="block text-sm font-medium text-gray-700">Setup Downtime (minutes/shift)</label>
                        <input type="number" id="setup-downtime" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., 15">
                    </div>
                    <div>
                        <label for="maintenance-downtime" class="block text-sm font-medium text-gray-700">Maintenance Downtime (minutes/shift)</label>
                        <input type="number" id="maintenance-downtime" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., 10">
                    </div>
                </div>
                <!-- Variable Production Rate Inputs -->
                <div id="variable-rate-inputs" class="hidden">
                    <div>
                        <label for="actual-cycle-time-mean" class="block text-sm font-medium text-gray-700">Average Actual Cycle Time (seconds/unit)</label>
                        <input type="number" id="actual-cycle-time-mean" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., 12">
                    </div>
                    <div>
                        <label for="actual-cycle-time-std" class="block text-sm font-medium text-gray-700">Standard Deviation of Actual Cycle Time (seconds/unit)</label>
                        <input type="number" id="actual-cycle-time-std" class="mt-1 p-2 w-full border rounded-md" placeholder="e.g., 2">
                    </div>
                </div>
            </div>
            <button onclick="calculateOEE()" class="mt-6 bg-blue-900 text-white px-4 py-2 rounded-md hover:bg-blue-800">Calculate</button>

            <!-- Results -->
            <div id="results" class="mt-6 hidden">
                <h3 class="text-xl font-semibold mb-2">Results</h3>
                <div id="calculation-results"></div>
                <div id="interpretation" class="mt-4">
                    <h4 class="text-lg font-semibold">Interpretation</h4>
                    <p id="interpretation-text" class="text-gray-600"></p>
                </div>
                <div id="recommendation" class="mt-4">
                    <h4 class="text-lg font-semibold">Recommendation</h4>
                    <p id="recommendation-text" class="text-gray-600"></p>
                </div>
            </div>
        </section>

        <!-- OEE Methods Explanation -->
        <section class="mt-8">
            <h3 class="text-2xl font-semibold mb-4">OEE Methods and When to Use Them</h3>
            <div class="space-y-4">
                <div>
                    <h4 class="text-lg font-semibold">Standard OEE</h4>
                    <p class="text-gray-600">Use for basic OEE calculation with total downtime, ideal for stable operations. Formula: OEE = Availability * Performance * Quality, where Availability = (Planned Time - Downtime)/Planned Time, Performance = (Total Units * Ideal Cycle Time)/(Planned Time - Downtime), Quality = (Total Units - Defective Units)/Total Units.</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold">OEE with Shift-Based Downtime</h4>
                    <p class="text-gray-600">Use when downtime is categorized (e.g., setup, maintenance) to identify specific losses. Formula: Same as Standard OEE, but downtime is broken into components (setup, maintenance, other) for detailed analysis.</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold">OEE with Variable Production Rates</h4>
                    <p class="text-gray-600">Use when production speed varies, incorporating actual cycle time variability. Formula: Adjusts Performance using average actual cycle time and variability.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-blue-900 text-white text-center p-4">
        <p>&copy; 2025 IE Toolkit. All rights reserved.</p>
    </footer>

    <script>
        function toggleInputs() {
            const method = document.getElementById('oee-method').value;
            document.getElementById('shift-downtime-inputs').classList.add('hidden');
            document.getElementById('variable-rate-inputs').classList.add('hidden');
            if (method === 'shift-downtime') {
                document.getElementById('shift-downtime-inputs').classList.remove('hidden');
            } else if (method === 'variable-rate') {
                document.getElementById('variable-rate-inputs').classList.remove('hidden');
            }
            document.getElementById('results').classList.add('hidden');
        }

        function calculateOEE() {
            const method = document.getElementById('oee-method').value;
            const plannedTime = parseFloat(document.getElementById('planned-time').value);
            let downtime = parseFloat(document.getElementById('downtime').value);
            const idealCycleTime = parseFloat(document.getElementById('ideal-cycle-time').value);
            const totalUnits = parseFloat(document.getElementById('total-units').value);
            const defectiveUnits = parseFloat(document.getElementById('defective-units').value);

            // Validate common inputs
            if (isNaN(plannedTime) || isNaN(downtime) || isNaN(idealCycleTime) || isNaN(totalUnits) || isNaN(defectiveUnits) ||
                plannedTime <= 0 || downtime < 0 || idealCycleTime <= 0 || totalUnits < 0 || defectiveUnits < 0 || defectiveUnits > totalUnits || downtime > plannedTime) {
                alert('Please enter valid positive numbers for planned time, ideal cycle time, and total units. Downtime and defective units must be non-negative, with downtime ≤ planned time and defective units ≤ total units.');
                return;
            }

            let results = '';
            let interpretation = '';
            let recommendation = '';

            // Common calculations
            const operatingTime = plannedTime - downtime;
            const availability = operatingTime / plannedTime;
            const quality = totalUnits > 0 ? (totalUnits - defectiveUnits) / totalUnits : 0;

            if (method === 'standard') {
                // Standard OEE
                const performance = totalUnits > 0 ? (totalUnits * idealCycleTime) / (operatingTime * 60) : 0; // Convert minutes to seconds
                const oee = availability * performance * quality;

                results = `
                    <p>Availability: ${(availability * 100).toFixed(2)}%</p>
                    <p>Performance: ${(performance * 100).toFixed(2)}%</p>
                    <p>Quality: ${(quality * 100).toFixed(2)}%</p>
                    <p>OEE: ${(oee * 100).toFixed(2)}%</p>
                `;
                interpretation = `The Standard OEE is ${(oee * 100).toFixed(2)}%, driven by ${(availability * 100).toFixed(2)}% availability, ${(performance * 100).toFixed(2)}% performance, and ${(quality * 100).toFixed(2)}% quality. This reflects overall equipment productivity for a stable operation.`;
                recommendation = `Aim to maintain or improve OEE above ${(oee * 100).toFixed(2)}%. Focus on reducing downtime (${downtime} minutes), optimizing cycle time (currently ${idealCycleTime} seconds/unit), and minimizing defects (${defectiveUnits} units).`;

            } else if (method === 'shift-downtime') {
                const setupDowntime = parseFloat(document.getElementById('setup-downtime').value) || 0;
                const maintenanceDowntime = parseFloat(document.getElementById('maintenance-downtime').value) || 0;
                const totalInputDowntime = setupDowntime + maintenanceDowntime;
                
                // Validate shift-based downtime inputs
                if (isNaN(setupDowntime) || isNaN(maintenanceDowntime) || setupDowntime < 0 || maintenanceDowntime < 0) {
                    alert('Please enter valid non-negative numbers for setup and maintenance downtime.');
                    return;
                }
                if (totalInputDowntime > downtime) {
                    alert('The sum of setup and maintenance downtime cannot exceed total unplanned downtime.');
                    return;
                }

                // OEE with Shift-Based Downtime
                const otherDowntime = downtime - totalInputDowntime;
                const performance = totalUnits > 0 ? (totalUnits * idealCycleTime) / (operatingTime * 60) : 0; // Convert minutes to seconds
                const oee = availability * performance * quality;

                results = `
                    <p>Availability: ${(availability * 100).toFixed(2)}% (Setup: ${setupDowntime.toFixed(2)} min, Maintenance: ${maintenanceDowntime.toFixed(2)} min, Other: ${otherDowntime.toFixed(2)} min)</p>
                    <p>Performance: ${(performance * 100).toFixed(2)}%</p>
                    <p>Quality: ${(quality * 100).toFixed(2)}%</p>
                    <p>OEE: ${(oee * 100).toFixed(2)}%</p>
                `;
                interpretation = `The OEE with Shift-Based Downtime is ${(oee * 100).toFixed(2)}%, with availability at ${(availability * 100).toFixed(2)}% (including ${setupDowntime.toFixed(2)} minutes setup, ${maintenanceDowntime.toFixed(2)} minutes maintenance, and ${otherDowntime.toFixed(2)} minutes other downtime). Performance is ${(performance * 100).toFixed(2)}%, and quality is ${(quality * 100).toFixed(2)}%.`;
                recommendation = `Target an OEE above ${(oee * 100).toFixed(2)}%. Reduce setup downtime (${setupDowntime.toFixed(2)} min) using SMED techniques, optimize maintenance schedules (${maintenanceDowntime.toFixed(2)} min), and investigate other downtime (${otherDowntime.toFixed(2)} min). Improve quality to reduce defects (${defectiveUnits} units).`;

            } else if (method === 'variable-rate') {
                const actualCycleTimeMean = parseFloat(document.getElementById('actual-cycle-time-mean').value);
                const actualCycleTimeStd = parseFloat(document.getElementById('actual-cycle-time-std').value);
                if (isNaN(actualCycleTimeMean) || isNaN(actualCycleTimeStd) || actualCycleTimeMean <= 0 || actualCycleTimeStd < 0) {
                    alert('Please enter valid positive numbers for average actual cycle time and non-negative standard deviation.');
                    return;
                }
                // OEE with Variable Production Rates
                const performance = idealCycleTime / actualCycleTimeMean;
                const oee = availability * performance * quality;

                results = `
                    <p>Availability: ${(availability * 100).toFixed(2)}%</p>
                    <p>Performance: ${(performance * 100).toFixed(2)}% (Actual Cycle Time Variability: ±${actualCycleTimeStd.toFixed(2)} sec)</p>
                    <p>Quality: ${(quality * 100).toFixed(2)}%</p>
                    <p>OEE: ${(oee * 100).toFixed(2)}%</p>
                `;
                interpretation = `The OEE with Variable Production Rates is ${(oee * 100).toFixed(2)}%, with availability at ${(availability * 100).toFixed(2)}%, performance at ${(performance * 100).toFixed(2)}% (based on an average actual cycle time of ${actualCycleTimeMean.toFixed(2)} seconds with ±${actualCycleTimeStd.toFixed(2)} seconds variability), and quality at ${(quality * 100).toFixed(2)}%.`;
                recommendation = `Strive to improve OEE beyond ${(oee * 100).toFixed(2)}%. Reduce downtime (${downtime.toFixed(2)} minutes), stabilize production rates (current variability ±${actualCycleTimeStd.toFixed(2)} seconds), and enhance quality to minimize defects (${defectiveUnits} units). Consider process standardization to reduce cycle time variability.`;
            }

            document.getElementById('calculation-results').innerHTML = results;
            document.getElementById('interpretation-text').innerText = interpretation;
            document.getElementById('recommendation-text').innerText = recommendation;
            document.getElementById('results').classList.remove('hidden');
        }
    </script>
</body>
</html>
